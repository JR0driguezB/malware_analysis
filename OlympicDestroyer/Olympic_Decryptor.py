
# JR0driguezB

# Script to decrypt Olympic Destroyer resources

from Crypto.Cipher import AES
import binascii
import sys

key = binascii.unhexlify("202cb962ac59075b964b07152d234b70202cb962ac59075b964b07152d234b70")

iv = binascii.unhexlify("00000000000000000000000000000000")

cipher = AES.new(key, AES.MODE_CBC, iv)

if __name__ == '__main__':

	if len(sys.argv) < 3:
		print("[*] {} <encrypted file> <decrypted file>".format(sys.argv[0]));

	else:

		infile = sys.argv[1]
		outfile = sys.argv[2]

		with open(infile, "r") as bin_file:
			encrypted_file = bin_file.read()

		IsMultipleOf16 = len(encrypted_file) % 16

		if IsMultipleOf16 != 0:
			encrypted_file = encrypted_file[:-IsMultipleOf16]

		decrypted_file = cipher.decrypt(encrypted_file)

		with open(outfile, 'w') as exe_file:
			exe_file.write(decrypted_file)
